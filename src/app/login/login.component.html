<!-- ROOT: Layout responsivo con wave de fondo -->
<section class="h-screen w-full flex flex-col lg:flex-row relative overflow-hidden">

  <!-- Wave global -->
  <svg class="absolute bottom-0 left-0 w-full h-full z-0 text-white" viewBox="0 0 1440 320" preserveAspectRatio="none"
    xmlns="http://www.w3.org/2000/svg">
    <path fill="currentColor"
      d="M0,288L48,272C96,256,192,224,288,197.3C384,171,480,149,576,149.3C672,149,768,171,864,186.7C960,203,1056,213,1152,192C1248,171,1344,117,1392,90.7L1440,64L1440,0L1392,0C1344,0,1248,0,1152,0C1056,0,960,0,864,0C768,0,672,0,576,0C480,0,384,0,288,0C192,0,96,0,48,0L0,0Z" />
  </svg>

  <!-- Carrusel -->
  <aside class="hidden lg:flex flex-1 relative items-center justify-center 
           bg-gradient-to-b from-[var(--green-soft)] via-white to-[var(--red-dark)] z-10"
    (mouseenter)="pauseCarousel()" (mouseleave)="resumeCarousel()" (touchstart)="pauseCarousel()"
    (touchend)="resumeCarousel()" aria-label="Carrusel de imágenes institucionales">

    <!-- Texto arriba del carrusel -->
    <div class="absolute top-16 z-30 w-full text-center px-6">
      <h2 class="text-3xl font-semibold text-[#680404] drop-shadow-md">
        Bienvenido a la plataforma
      </h2>
      <p class="mt-2 text-shadow text-black/90 drop-shadow-md">
        Accede con tu usuario para continuar. Si tienes problemas contacta a servicios escolares.
      </p>
    </div>

    <!-- Slides -->
    <div class="absolute inset-0 flex items-center justify-center">
      <ng-container *ngFor="let slide of slides; let i = index">
        <div class="carousel-slide" [class.active]="i === currentSlide"
          [attr.aria-hidden]="i === currentSlide ? 'false' : 'true'">
          <img [src]="slide.src" [alt]="slide.alt" class="carousel-img" loading="lazy" />
        </div>
      </ng-container>
    </div>

    <!-- Indicadores -->
    <div class="absolute bottom-6 z-30 flex gap-2">
      <button *ngFor="let s of slides; let i = index" class="w-2 h-2 rounded-full"
        [ngClass]="{'bg-red-600': i === currentSlide, 'bg-white/40': i !== currentSlide}" (click)="goToSlide(i)"
        [attr.aria-label]="'Ir a la diapositiva ' + (i+1)">
      </button>
    </div>
  </aside>
  
  <!-- ========================
       MAIN: Card login
  ========================= -->
  <!-- Login -->
  <main class="flex-1 flex items-center justify-center p-6 lg:p-12 relative z-10">
    <div class="w-full max-w-md bg-white rounded-lg shadow-lg p-6">
      <!-- Logo visible en todas las pantallas -->
      <div class="mb-6 text-center">
        <img src="assets/images/unsis-logo.png" alt="Logo UNSIS" class="mx-auto w-40 h-auto object-contain">
      </div>
      <!-- Resto del login -->
      <!-- Título -->
      <div class="mb-4 text-center">
        <h1 class="text-2xl font-semibold text-gray-700">Inicio de sesión</h1>
        <p class="mt-1 text-sm text-gray-500">Ingresa tus credenciales para acceder</p>
      </div>

      <!-- Formulario -->
      <form (ngSubmit)="onSubmit()" #loginForm="ngForm" class="space-y-4">

        <!-- Campo usuario -->
        <div>
          <label for="usuario" class="block text-sm font-medium text-[#195251] mb-1">Usuario</label>
          <div
            class="flex items-center border border-gray-200 rounded-md p-2 focus-within:ring-2 focus-within:ring-[#195251]">
            <svg class="w-5 h-5 text-[#832934] mr-2 flex-shrink-0" fill="currentColor" viewBox="0 0 24 24">
              <path 
                d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z" />
            </svg>

            <input id="usuario" name="username" type="text" [(ngModel)]="credentials.username" required
              autocomplete="username"
              class="w-full bg-transparent focus:outline-none placeholder-gray-400 text-gray-700"
              placeholder="usuario de aspirante" aria-label="Usuario" />
          </div>
        </div>

        <!-- Campo contraseña -->
        <div>
          <label for="password" class="block text-sm font-medium text-[#195251] mb-1">Contraseña</label>
          <div
            class="relative flex items-center border border-gray-200 rounded-md p-2 focus-within:ring-2 focus-within:ring-[#832934]">
            <svg class="w-5 h-5 text-[#832934] mr-2 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                d="M12 11c1.104 0 2 .896 2 2v2h-4v-2c0-1.104.896-2 2-2zm6 0V7a6 6 0 00-12 0v4H4v10h16V11h-2z" />
            </svg>
                
            <input id="password" name="password" [type]="showPassword ? 'text' : 'password'"
              [(ngModel)]="credentials.password" required autocomplete="current-password"
              class="w-full bg-transparent focus:outline-none placeholder-gray-400 text-gray-700 pr-10"
              placeholder="Ingresa tu contraseña" aria-label="Contraseña" />

            <!-- Botón show/hide -->
            <button type="button" (click)="toggleShowPassword()"
              class="absolute right-2 p-1 text-gray-500 hover:text-[#195251] focus:outline-none"
              [attr.aria-pressed]="showPassword"
              [attr.aria-label]="showPassword ? 'Ocultar contraseña' : 'Mostrar contraseña'">
              <!-- Icono ojo -->
              <svg *ngIf="!showPassword" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none"
                viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M2.458 12C3.732 7.943 7.523 5 12 5c4.477 0 8.268 2.943 9.542 7-1.274 4.057-5.065 7-9.542 7-4.477 0-8.268-2.943-9.542-7z" />
              </svg>
              
              <!-- Icono ojo tachado -->
              <svg *ngIf="showPassword" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 24 24"
                stroke="currentColor" fill="none">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                  d="M13.875 18.825A10.05 10.05 0 0112 19c-4.477 0-8.268-2.943-9.542-7a9.956 9.956 0 012.122-3.333" />
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6.1 6.1L17.9 17.9" />
              </svg>
            </button>
          </div>
        </div>

        <!-- Mensajes -->
        <div *ngIf="error"
          class="flex items-start bg-red-50 border border-red-200 text-red-700 px-4 py-2 rounded text-sm">
          <svg class="w-5 h-5 mr-2 text-red-400 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 8v4m0 4h.01M21 12A9 9 0 113 12a9 9 0 0118 0z" />
          </svg>
          <span>{{ error || 'Ocurrió un error al iniciar sesión. Por favor, verifica tus datos e inténtalo de nuevo.'
            }}</span>
        </div>

        <div *ngIf="success"
          class="flex items-center bg-green-50 border border-green-200 text-green-700 px-4 py-2 rounded text-sm animate-fade-in">
          <svg class="w-5 h-5 mr-2 text-green-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
          </svg>
          <span>{{ success }}</span>
        </div>

        <!-- Botón -->
        <button type="submit" [disabled]="!loginForm.valid"
          class="w-full py-2 rounded-md text-white font-semibold shadow transition-colors disabled:opacity-50"
          [ngClass]="{'bg-[var(--btn-main,#0b5350)] hover:bg-[var(--btn-hover,#821a23)]': loginForm.valid}">
          Ingresar
        </button>
      </form>

      <!-- Links -->
      <div class="mt-4 text-center text-sm text-gray-500">
        <a class="text-[#195251] hover:underline" href="https://www.unsis.edu.mx/web/nuestra_universidad/contacto">
        Servicios Escolares</a>
      </div>
    </div>
  </main>

</section>